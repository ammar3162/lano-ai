<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Lano AI â€” Ù…Ø³Ø§Ø¹Ø¯ Ù…Ø·Ø¹Ù… Ù„Ø§Ù†Ùˆ ğŸ¤–ğŸ</title>
<style>
  body{font-family:"Tajawal",sans-serif;background:#3E1A1A;color:#FAF7EF;margin:0;display:flex;justify-content:center;align-items:center;height:100vh;}
  .app{width:90%;max-width:600px;background:#4A1E1E;padding:16px;border-radius:14px;box-shadow:0 0 10px rgba(0,0,0,.3);}
  h2{text-align:center;margin-bottom:12px;color:#EDE3D6;}
  .chat{height:60vh;overflow-y:auto;padding:10px;background:#411919;border-radius:10px;}
  .msg{padding:10px 14px;margin:6px 0;border-radius:10px;max-width:80%;line-height:1.5;}
  .ai{background:#EDE3D6;color:#2d1e10;border-top-right-radius:4px;}
  .user{background:#8C3C3C;color:#fff;border-top-left-radius:4px;margin-left:auto;}
  .input-area{display:flex;margin-top:10px;gap:8px;}
  input,button{padding:10px;border:none;border-radius:10px;}
  input{flex:1;background:#2B1212;color:#FAF7EF;}
  button{background:#D4AF37;color:#3E1A1A;font-weight:bold;cursor:pointer;}
  button:hover{opacity:.9;}
  .key-box{margin-bottom:10px;text-align:center;}
  .key-box input{width:100%;text-align:center;}
</style>
</head>
<body>
<div class="app">
  <h2>ğŸ Ù…Ø³Ø§Ø¹Ø¯ Ù…Ø·Ø¹Ù… Ù„Ø§Ù†Ùˆ Ø§Ù„Ø°ÙƒÙŠ</h2>

  <div class="key-box">
    <input id="apiKey" type="password" placeholder="ğŸ”‘ Ø¶Ø¹ Ù…ÙØªØ§Ø­ OpenAI Ù‡Ù†Ø§ (Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©)">
    <button onclick="saveKey()">Ø­ÙØ¸ Ø§Ù„Ù…ÙØªØ§Ø­</button>
  </div>

  <div class="chat" id="chat"></div>

  <div class="input-area">
    <input id="msg" placeholder="Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ Ø£Ùˆ Ù‚Ù„ (Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªÙˆØµÙŠØ©)...">
    <button id="send">Ø¥Ø±Ø³Ø§Ù„</button>
  </div>
</div>

<script>
const chat=document.getElementById("chat");
const msg=document.getElementById("msg");
const send=document.getElementById("send");

// Ø­ÙØ¸ Ù…ÙØªØ§Ø­ API
let apiKey=localStorage.getItem("OPENAI_KEY")||"";
if(apiKey) document.getElementById("apiKey").value=apiKey;

function saveKey(){
  apiKey=document.getElementById("apiKey").value.trim();
  if(apiKey.startsWith("sk-")){localStorage.setItem("OPENAI_KEY",apiKey);alert("âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù…ÙØªØ§Ø­ Ø¨Ù†Ø¬Ø§Ø­");}
  else alert("âŒ Ø§Ù„Ù…ÙØªØ§Ø­ ØºÙŠØ± ØµØ§Ù„Ø­");
}

// ØªØ±Ø­ÙŠØ¨ Ø´Ø®ØµÙŠ Ø¨Ø§Ù„Ø§Ø³Ù…
let userName = localStorage.getItem("LANO_USER_NAME");
if (!userName) {
  userName = prompt("ğŸ‘‹ Ù…Ø±Ø­Ø¨Ù‹Ø§! Ù…Ø§ Ø§Ø³Ù…ÙƒØŸ");
  if (userName) {
    localStorage.setItem("LANO_USER_NAME", userName);
  } else {
    userName = "Ø¶ÙŠÙ";
  }
}

function addMsg(txt,cls="ai"){const div=document.createElement("div");div.className="msg "+cls;div.textContent=txt;chat.appendChild(div);chat.scrollTop=chat.scrollHeight;}

async function sendMsg(){
  const userMsg=msg.value.trim();
  if(!userMsg)return;
  msg.value="";
  addMsg(userMsg,"user");

  if(!apiKey){addMsg("âš ï¸ Ù„Ù… ÙŠØªÙ… Ø¥Ø¯Ø®Ø§Ù„ Ù…ÙØªØ§Ø­ API Ø¨Ø¹Ø¯.","ai");return;}

  addMsg("ğŸ¤” Ø¬Ø§Ø±Ù Ø§Ù„ØªÙÙƒÙŠØ±...","ai");

  const systemPrompt=`Ø£Ù†Øª Ù…Ø³Ø§Ø¹Ø¯ Ø°ÙƒÙŠ Ø±Ø³Ù…ÙŠ ØªØ§Ø¨Ø¹ Ù„Ù…Ø·Ø¹Ù… Ù„Ø§Ù†Ùˆ Ø§Ù„Ø¥ÙŠØ·Ø§Ù„ÙŠ.
ØªØªØ­Ø¯Ø« Ø¨Ø£Ø³Ù„ÙˆØ¨ ØªØ±Ø­ÙŠØ¨ÙŠ ÙˆÙˆØ¯ÙˆØ¯.
Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„ Ù‡Ùˆ: ${userName}.
Ù…Ù‡Ø§Ù…Ùƒ ÙÙ‚Ø·:
- Ù…Ø³Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¹Ù…ÙŠÙ„ ÙÙŠ Ù…Ø¹Ø±ÙØ© Ø§Ù„Ù…Ù†ÙŠÙˆØŒ Ø§Ù„Ø£Ø³Ø¹Ø§Ø±ØŒ ÙˆØ§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª.
- Ø¥Ø°Ø§ Ø³ÙØ¦Ù„Øª Ø¹Ù† Ø´ÙŠØ¡ Ù„Ø§ ÙŠØ®Øµ Ø§Ù„Ù…Ø·Ø¹Ù…ØŒ Ù‚Ù„ Ø¨Ù„Ø·Ù:
"Ø£Ù†Ø§ ÙÙ‚Ø· Ù…Ø³Ø§Ø¹Ø¯ Ù…Ø·Ø¹Ù… Ù„Ø§Ù†Ùˆ ğŸ• Ø£Ù‚Ø¯Ø± Ø£Ø³Ø§Ø¹Ø¯Ùƒ ÙÙŠ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø£Ùˆ Ø§Ù‚ØªØ±Ø§Ø­ Ø§Ù„Ø£Ø·Ø¨Ø§Ù‚."
ÙƒÙ† Ø¨Ø´ÙˆØ´Ù‹Ø§ ÙˆØªØ®Ø§Ø·Ø¨ Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø¨Ø§Ø³Ù…Ù‡ Ø¯Ø§Ø¦Ù…Ù‹Ø§ Ù…Ø«Ù„:
"Ø£Ù‡Ù„Ù‹Ø§ ${userName}! ÙŠØ³Ø¹Ø¯Ù†ÙŠ Ø£Ø³Ø§Ø¹Ø¯Ùƒ Ø§Ù„ÙŠÙˆÙ… ğŸŒ¿"
`;

  const messages=[
    {role:"system",content:systemPrompt},
    {role:"user",content:userMsg}
  ];

  try{
    const res=await fetch("https://api.openai.com/v1/chat/completions",{
      method:"POST",
      headers:{
        "Content-Type":"application/json",
        "Authorization":`Bearer ${apiKey}`
      },
      body:JSON.stringify({model:"gpt-4o-mini",messages,temperature:0.9,max_tokens:400})
    });
    const data=await res.json();
    chat.lastChild.remove();
    addMsg(data.choices?.[0]?.message?.content?.trim()||"ØªØ¹Ø°Ø± Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø±Ø¯.","ai");
  }catch(e){
    chat.lastChild.remove();
    addMsg("âš ï¸ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø¯Ù…Ø©.","ai");
    console.error(e);
  }
}

send.onclick=sendMsg;
msg.addEventListener("keydown",e=>{if(e.key==="Enter")sendMsg();});

// Ø§Ù„ØªØ±Ø­ÙŠØ¨ Ø§Ù„Ù…Ø¨Ø¯Ø¦ÙŠ Ø¨Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
addMsg(`ğŸ‘‹ Ø£Ù‡Ù„Ù‹Ø§ ${userName}! ÙŠØ³Ø¹Ø¯Ù†ÙŠ Ø£Ø³Ø§Ø¹Ø¯Ùƒ ÙÙŠ Ø§Ø®ØªÙŠØ§Ø± ÙˆØ¬Ø¨ØªÙƒ Ø§Ù„Ù…Ø«Ø§Ù„ÙŠØ© Ù…Ù† Ù…Ø·Ø¹Ù… Ù„Ø§Ù†Ùˆ ğŸ•âœ¨`,"ai");
</script>
</body>
</html>
